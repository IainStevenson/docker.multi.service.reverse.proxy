{
	"info": {
		"_postman_id": "f7308fe5-ee6b-4ea4-b05e-4ab7a1087193",
		"name": "local.myinfo.world",
		"description": "A docker orchestration of multiple microservices behind a proxy uysing https and letsencrypt.\r\nAuthentication and authorisation are not included its a simple https scheme for transport security and endpoint validation",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "1467123"
	},
	"item": [
		{
			"name": "Identity",
			"item": [
				{
					"name": "Get Identity Server Well known openid configuration",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"pm.collectionVariables.set(\"postCount\", 0)"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"postCount\", 0)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/identity/.well-known/openid-configuration",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"identity",
								".well-known",
								"openid-configuration"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Mvc",
			"item": [
				{
					"name": "Test access to Support with /support/home/privacy",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/support/home/privacy",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"support",
								"home",
								"privacy"
							]
						},
						"description": "Test required  direct access to Container 2 (Support) (support) "
					},
					"response": []
				},
				{
					"name": "Test access to Store by default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/store",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"store"
							]
						},
						"description": "Test required  direct access to Container 1 (Store) (store) "
					},
					"response": []
				},
				{
					"name": "Test access to Store with /store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/store",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"store"
							]
						},
						"description": "Test required  direct access to Container 1 (Store) (store) "
					},
					"response": []
				},
				{
					"name": "Test access to Store with /store/home",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/store/home",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"store",
								"home"
							]
						},
						"description": "Test required  direct access to Container 1 (Store) (store) "
					},
					"response": []
				},
				{
					"name": "Test access to Store with /store/home/privacy",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/store/home/privacy",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"store",
								"home",
								"privacy"
							]
						},
						"description": "Test required  direct access to Container 1 (Store) (store) "
					},
					"response": []
				},
				{
					"name": "Test access to Store with /store/weatherforecast redirects to login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Status code is 200\", () => {\r",
									"    pm.response.text().includes(\"<title>IdentityServer4</title>\");\r",
									"    pm.response.text().includes(\"<h1>Login</h1>\");\r",
									"    \r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/store/weatherforecast",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"store",
								"weatherforecast"
							]
						},
						"description": "Test required  direct access to Container 1 (Store) (store) "
					},
					"response": []
				},
				{
					"name": "Test access to Support with /support/home",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/support/home",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"support",
								"home"
							]
						},
						"description": "Test required  direct access to Container 2 (Support) (support) "
					},
					"response": []
				},
				{
					"name": "Test access to Support with /support",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUri}}/support",
							"host": [
								"{{baseUri}}"
							],
							"path": [
								"support"
							]
						},
						"description": "Test required  direct access to Container 2 (Support) (support) "
					},
					"response": []
				}
			]
		},
		{
			"name": "Api",
			"item": [
				{
					"name": "Resource",
					"item": [
						{
							"name": "CRUD",
							"item": [
								{
									"name": "POST is Created for HATEOAS",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var jsonData = pm.response.json();\r",
													"    \r",
													"console.log(\"Recieved Body: \",jsonData)\r",
													"\r",
													"\r",
													"pm.test(\"Extract Last Values\", function () {\r",
													"    pm.collectionVariables.set('lastId', jsonData.id)\r",
													"    pm.collectionVariables.set('lastETag', jsonData.etag);\r",
													"    pm.collectionVariables.set('lastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('beforeLastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('lastContentKeys', jsonData.content)\r",
													"    pm.collectionVariables.set('lastKeyValue', jsonData.content.id)\r",
													"\r",
													"    console.log('lastId', jsonData.id);\r",
													"    console.log('lastETag', jsonData.etag);\r",
													"    console.log('lastModified', jsonData.created);\r",
													"    console.log('beforeLastModified', jsonData.created);\r",
													"    console.log('lastContentKeys', jsonData.content);\r",
													"    console.log('lastKeyValue', jsonData.content.id);\r",
													"\r",
													"\r",
													"    pm.collectionVariables.set('lastPostUrl', jsonData.links[0].href);\r",
													"    pm.collectionVariables.set('lastListUrl', jsonData.links[1].href);\r",
													"    pm.collectionVariables.set('lastGetUrl', jsonData.links[2].href);\r",
													"    pm.collectionVariables.set('lastPutUrl', jsonData.links[3].href);\r",
													"    pm.collectionVariables.set('lastDeleteUrl', jsonData.links[4].href);\r",
													"\r",
													"    console.log('lastPostUrl', pm.collectionVariables.get('lastPostUrl'));\r",
													"    console.log('lastListUrl',pm.collectionVariables.get('lastListUrl'));\r",
													"    console.log('lastGetUrl',pm.collectionVariables.get('lastGetUrl'));\r",
													"    console.log('lastPutUrl',pm.collectionVariables.get('lastPutUrl'));\r",
													"    console.log('lastDeleteUrl',pm.collectionVariables.get('lastDeleteUrl'));\r",
													"});\r",
													"\r",
													"\r",
													"pm.test(\"Status code is 201\", function () {\r",
													"    pm.response.to.have.status(201);      \r",
													"});\r",
													"\r",
													"pm.test(\"Location header is present\", function () {\r",
													"    pm.response.to.have.header(\"Location\");\r",
													"\r",
													"    var locationHeader = pm.response.headers.get(\"Location\");\r",
													"    console.log(\"Location header: \", locationHeader)\r",
													"    pm.collectionVariables.set(\"lastLocationHeader\", locationHeader);\r",
													"\r",
													"    var locationHeaderElements = locationHeader.split('/');\r",
													"    console.log(\"Location header Elements: \", locationHeaderElements)\r",
													"    console.log(\"# Location header Elements: \", locationHeaderElements.length)\r",
													"\r",
													"    var crudId = locationHeaderElements[5];\r",
													"\r",
													"    console.log(\"Location header ID: \", crudId)\r",
													"\r",
													"    pm.collectionVariables.set('lastId', crudId);\r",
													"\r",
													"});"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"const dateNow= new Date();\r",
													"console.log('Time Now: setting beforeLastModified' , dateNow.toISOString());\r",
													"pm.collectionVariables.set('beforeLastModified', dateNow.toISOString())"
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disabledSystemHeaders": {
											"content-type": true
										}
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"id\": {{$randomInt}}, \r\n    \"systolic\": 137,\r\n    \"diastolic\": 95,\r\n    \"pulse\": 100\r\n}"
										},
										"url": {
											"raw": "{{baseUri}}/api/resources/{{namespace}}?keys=id",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{namespace}}"
											],
											"query": [
												{
													"key": "keys",
													"value": "id"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK by Location Header",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{lastLocationHeader}}",
											"host": [
												"{{lastLocationHeader}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK from HATEOAS get Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{lastListUrl}}",
											"host": [
												"{{lastListUrl}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK byHATEOAS Get Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{lastGetUrl}}",
											"host": [
												"{{lastGetUrl}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "PUT is OK via HATEOAS PUT Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"\r",
													"pm.test(\"Extract Last Values\", function () {\r",
													"    var jsonData = pm.response.json();\r",
													"    pm.collectionVariables.set('lastId', jsonData.id)\r",
													"    pm.collectionVariables.set('lastETag', jsonData.etag);\r",
													"    pm.collectionVariables.set('lastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('lastContentKeys', jsonData.content)\r",
													"    pm.collectionVariables.set('lastKeyValue', jsonData.content.id)    \r",
													"    \r",
													"    console.log('lastId', jsonData.id);\r",
													"    console.log('lastETag', jsonData.etag);\r",
													"    console.log('lastModified', jsonData.created);\r",
													"    console.log('lastContentKeys', jsonData.content);\r",
													"    console.log('lastKeyValue', jsonData.content.id);\r",
													"});"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"const dateNow= new Date();\r",
													"console.log('Time Now: setting beforeLastModified' , dateNow.toISOString());\r",
													"pm.collectionVariables.set('beforeLastModified', dateNow.toISOString())\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disabledSystemHeaders": {
											"content-type": true
										}
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n     \"id\": {{lastKeyValue}}, \r\n     \"systolic\": 137,\r\n    \"diastolic\": 95,\r\n    \"pulse\": 102\r\n}"
										},
										"url": {
											"raw": "{{lastPutUrl}}",
											"host": [
												"{{lastPutUrl}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "DELETE is NoContent on HATEOS delete url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 204\", function () {\r",
													"    pm.response.to.have.status(204);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "DELETE",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{lastDeleteUrl}}",
											"host": [
												"{{lastDeleteUrl}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "POST is Created",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var postCount = pm.collectionVariables.get(\"postCount\");\r",
													"postCount ++;\r",
													"\r",
													"pm.collectionVariables.set(\"postCount\", postCount)\r",
													"console.log(\"Post count: \", postCount)\r",
													"\r",
													"var jsonData = pm.response.json();\r",
													"    \r",
													"console.log(\"Recieved Body: \",jsonData)\r",
													"\r",
													"\r",
													"pm.test(\"Extract Last Values\", function () {\r",
													"    pm.collectionVariables.set('lastId', jsonData.id)\r",
													"    pm.collectionVariables.set('lastETag', jsonData.etag);\r",
													"    pm.collectionVariables.set('lastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('beforeLastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('lastContentKeys', jsonData.content)\r",
													"    pm.collectionVariables.set('lastKeyValue', jsonData.content.id)\r",
													"\r",
													"    console.log('lastId', jsonData.id);\r",
													"    console.log('lastETag', jsonData.etag);\r",
													"    console.log('lastModified', jsonData.created);\r",
													"    console.log('beforeLastModified', jsonData.created);\r",
													"    console.log('lastContentKeys', jsonData.content);\r",
													"    console.log('lastKeyValue', jsonData.content.id);\r",
													"\r",
													"\r",
													"    pm.collectionVariables.set('lastPostUrl', jsonData.links[0].href);\r",
													"    pm.collectionVariables.set('lastListUrl', jsonData.links[1].href);\r",
													"    pm.collectionVariables.set('lastGetUrl', jsonData.links[2].href);\r",
													"    pm.collectionVariables.set('lastPutUrl', jsonData.links[3].href);\r",
													"    pm.collectionVariables.set('lastDeleteUrl', jsonData.links[4].href);\r",
													"\r",
													"    console.log('lastPostUrl', pm.collectionVariables.get('lastPostUrl'));\r",
													"    console.log('lastListUrl',pm.collectionVariables.get('lastListUrl'));\r",
													"    console.log('lastGetUrl',pm.collectionVariables.get('lastGetUrl'));\r",
													"    console.log('lastPutUrl',pm.collectionVariables.get('lastPutUrl'));\r",
													"    console.log('lastDeleteUrl',pm.collectionVariables.get('lastDeleteUrl'));\r",
													"});\r",
													"\r",
													"\r",
													"pm.test(\"Status code is 201\", function () {\r",
													"    pm.response.to.have.status(201);      \r",
													"});\r",
													"\r",
													"pm.test(\"Location header is present\", function () {\r",
													"    pm.response.to.have.header(\"Location\");\r",
													"\r",
													"    var locationHeader = pm.response.headers.get(\"Location\");\r",
													"    console.log(\"Location header: \", locationHeader)\r",
													"    pm.collectionVariables.set(\"lastLocationHeader\", locationHeader);\r",
													"\r",
													"    var locationHeaderElements = locationHeader.split('/');\r",
													"    console.log(\"Location header Elements: \", locationHeaderElements)\r",
													"    console.log(\"# Location header Elements: \", locationHeaderElements.length)\r",
													"\r",
													"    var crudId = locationHeaderElements[5];\r",
													"\r",
													"    console.log(\"Location header ID: \", crudId)\r",
													"\r",
													"    pm.collectionVariables.set('lastId', crudId);\r",
													"\r",
													"});"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"const dateNow= new Date();\r",
													"console.log('Time Now: setting beforeLastModified' , dateNow.toISOString());\r",
													"pm.collectionVariables.set('beforeLastModified', dateNow.toISOString())"
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disabledSystemHeaders": {
											"content-type": true
										}
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"id\": {{$randomInt}}, \r\n    \"systolic\": 137,\r\n    \"diastolic\": 95,\r\n    \"pulse\": 100\r\n}"
										},
										"url": {
											"raw": "{{baseUri}}/api/resources/{{namespace}}?keys=id",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{namespace}}"
											],
											"query": [
												{
													"key": "keys",
													"value": "id"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK by namespace and id",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK only by id",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is NotModified if-modified-since lastmodified",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 304\", function () {\r",
													"    pm.response.to.have.status(304);\r",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-Modified-Since",
												"value": "{{lastModified}}",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is OK if-none-match oldetag",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-None-Match",
												"value": "oldetag",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET is NotModified if-none-match last etag",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 304\", function () {\r",
													"    pm.response.to.have.status(304);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-None-Match",
												"value": "{{lastETag}}",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "PUT is OK for update",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"\r",
													"pm.test(\"Extract Last Values\", function () {\r",
													"    var jsonData = pm.response.json();\r",
													"    console.log('lastId', jsonData.id);\r",
													"    pm.collectionVariables.set('lastId', jsonData.id)\r",
													"    console.log('lastETag', jsonData.etag);\r",
													"    pm.collectionVariables.set('lastETag', jsonData.etag);\r",
													"    console.log('lastModified', jsonData.created);\r",
													"    pm.collectionVariables.set('lastModified', jsonData.created);\r",
													"    console.log('lastContentKeys', jsonData.content);\r",
													"    pm.collectionVariables.set('lastContentKeys', jsonData.content)\r",
													"    console.log('lastKeyValue', jsonData.content.id);\r",
													"    pm.collectionVariables.set('lastKeyValue', jsonData.content.id)    \r",
													"});"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"const dateNow= new Date();\r",
													"console.log('Time Now: setting beforeLastModified' , dateNow.toISOString());\r",
													"pm.collectionVariables.set('beforeLastModified', dateNow.toISOString())\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disabledSystemHeaders": {
											"content-type": true
										}
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n     \"id\": {{lastKeyValue}}, \r\n    \"systolic\": 137,\r\n    \"diastolic\": 95,\r\n    \"pulse\": 101\r\n}"
										},
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "GET many is OK from namespace",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 200\", function () {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"\r",
													"pm.test(\"The body contains 1 or more items\", function () {\r",
													"    var jsonData = pm.response.json();\r",
													"    pm.expect(jsonData.length).to.not.eql(0);\r",
													"});\r",
													"\r",
													"\r",
													"var postCount = pm.collectionVariables.get(\"postCount\");\r",
													"var maxPostCount = pm.collectionVariables.get(\"maxPostCount\");\r",
													"\r",
													"if ( postCount < maxPostCount)\r",
													"{\r",
													"    console.log(\"Re-running initial POST\")\r",
													"    postman.setNextRequest(\"POST is Created\");\r",
													"}\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "DELETE is PreConditionFailed on delete with wrong timestamp",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 412\", function () {\r",
													"    pm.response.to.have.status(412);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "DELETE",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-Unmodified-Since",
												"value": "{{beforeLastModified}}",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "DELETE is PreConditionFailed on delete with different etag",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 412\", function () {\r",
													"    pm.response.to.have.status(412);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "DELETE",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-Match",
												"value": "badetag",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "DELETE is NoContent on delete with Match eTag",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 204\", function () {\r",
													"    pm.response.to.have.status(204);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "DELETE",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "If-Match",
												"value": "{{lastETag}}",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "DELETE is NotFound on re-delete",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Status code is 404\", function () {\r",
													"    pm.response.to.have.status(404);\r",
													"});\r",
													"\r",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{currentAccessToken}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{currentAccessToken}}.eyJuYmYiOjE2MDgwMjY0OTgsImV4cCI6MTYwODAzMDA5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2lkZW50aXR5IiwiYXVkIjoibWlDb25zZW50LkFwaSIsImNsaWVudF9pZCI6IjM2ODQ0QTZCLUEyM0UtNEY2OS1CNDU2LTQzQzFFOTVFOUVGMSIsInN1YiI6IjgwOWJmNDE3LTNkNWQtNDJlMi04OTAzLThlNzljYmUwYzEyYiIsImF1dGhfdGltZSI6MTYwODAyNjQ5NywiaWRwIjoibG9jYWwiLCJlbWFpbCI6InNkay5hbGljZUBtaUNvbnNlbnQuY29tIiwic2NvcGUiOlsibWlDb25zZW50LkFwaSJdLCJhbXIiOlsicHdkIl19.P1KxhAHZPwrWYCb9LjDQEv_ZteQPd1VDjWIkyWB0cOg9rK3uJ75ovLlcUqdJGuImjVVFaFp3eAFR5AqND8N1yqN1wg4MCa8IkN7YKv-KN5QnqtTLC3u81vj0xEKzfa_tXZirxEnv9N4Uz_Tw_-6nfPFT5qQcPXATq7Y_F51dp9sUoywcFEQdaQ6FeSAbKN7B86OEOE5kpbayCE6q7zk6-f_AwNcF1SOROXG8GHAUjPnw_pGg4nsbmvsFIQWk3fW9hgDJ3QsH94VLIuXVr_tEIah65iLbaq1wJUt-zUzyJcAEs8WpJE-rX15OE87IZn1ITHmL-xc14dAMCBxoW-hVQw",
													"type": "string"
												}
											]
										},
										"method": "DELETE",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"url": {
											"raw": "{{baseUri}}/api/resources/{{lastId}}/{{namespace}}",
											"host": [
												"{{baseUri}}"
											],
											"path": [
												"api",
												"resources",
												"{{lastId}}",
												"{{namespace}}"
											]
										}
									},
									"response": []
								}
							]
						}
					]
				}
			]
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{currentAccessToken}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"const echoPostRequest = {",
					"  url: 'https://local.myinfo.world/identity/connect/token',",
					"  method: 'POST',",
					"  header: 'Content-Type:application/x-www-form-urlencoded',",
					"  body: {",
					"    mode: 'application/json',",
					"    raw: 'grant_type=client_credentials&scope=myApi&client_id=Command&client_secret=secret'",
					"  }",
					"};",
					"",
					"getToken = true;",
					"",
					"if (!pm.environment.get('accessTokenExpiry') || ",
					"    !pm.environment.get('currentAccessToken')) {",
					"    console.log('Token or expiry date are missing')",
					"} else if (pm.environment.get('accessTokenExpiry') <= (new Date()).getTime()) {",
					"    console.log('Token is expired')",
					"} else {",
					"    getToken = false;",
					"    //console.log('No need to get a Token as expiry not passed');",
					"}",
					"",
					"",
					"if (getToken === true) {",
					"    console.log('Requesting token...');",
					"    pm.sendRequest(echoPostRequest, function (err, res) {",
					"        if (err === null) {",
					"            console.log('Token recieved, saving the token and expiry date')",
					"            var responseJson = res.json();",
					"            pm.environment.set('currentAccessToken', responseJson.access_token)",
					"    ",
					"            var expiryDate = new Date();",
					"            expiryDate.setSeconds(expiryDate.getSeconds() + responseJson.expires_in);",
					"            pm.environment.set('accessTokenExpiry', expiryDate.getTime());",
					"        }",
					"        else {",
					"            console.log('Error getting token', res.json());",
					"        }",
					"    });",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUri",
			"value": "https://local.myinfo.world"
		},
		{
			"key": "currentAccessToken",
			"value": ""
		},
		{
			"key": "lastId",
			"value": "ded1b09a-2ac8-4603-b2d7-5df697fac3d3"
		},
		{
			"key": "dataIdentifier",
			"value": "0",
			"type": "string"
		},
		{
			"key": "postCount",
			"value": 5,
			"type": "string"
		},
		{
			"key": "lastModified",
			"value": "2022-12-06T13:05:00.427159+00:00"
		},
		{
			"key": "lastETag",
			"value": "efIYYiWqCUKTVpdpYOSoEQ",
			"type": "string"
		},
		{
			"key": "lastContentKeys",
			"value": {
				"id": 670,
				"systolic": 137,
				"diastolic": 95,
				"pulse": 100
			},
			"type": "string"
		},
		{
			"key": "lastKeyValue",
			"value": 670,
			"type": "string"
		},
		{
			"key": "namespace",
			"value": "health/measurements/bloodpressure",
			"type": "string"
		},
		{
			"key": "beforeLastModified",
			"value": "2022-12-06T13:05:00.427159+00:00",
			"type": "string"
		},
		{
			"key": "maxPostCount",
			"value": "10",
			"type": "string"
		},
		{
			"key": "lastLocationHeader",
			"value": "https://local.myinfo.world/api/resources/ded1b09a-2ac8-4603-b2d7-5df697fac3d3/health/measurements/bloodpressure",
			"type": "string"
		},
		{
			"key": "lastPostUrl",
			"value": "https://local.myinfo.world/api/resources/",
			"type": "string"
		},
		{
			"key": "lastListUrl",
			"value": "https://local.myinfo.world/api/resources/",
			"type": "string"
		},
		{
			"key": "lastGetUrl",
			"value": "https://local.myinfo.world/api/resources/",
			"type": "string"
		},
		{
			"key": "lastPutUrl",
			"value": "https://local.myinfo.world/api/resources/",
			"type": "string"
		},
		{
			"key": "lastDeleteUrl",
			"value": "https://local.myinfo.world/api/resources/"
		}
	]
}