version: '3.4'

services:

  mystore.store:
    container_name:  mystore.store    
    image: ${DOCKER_REGISTRY-}mystore.store
    build:
      context: .
      dockerfile: Store/Dockerfile  
    depends_on:
     - mystore.mongo
     - mystore.api
     - mystore.identity    
    networks:      
      - mystore    

  mystore.support:
    container_name:  mystore.support
    image: ${DOCKER_REGISTRY-}mystore.support
    build:
      context: .
      dockerfile: Support/Dockerfile    
    depends_on:
     - mystore.mongo
     - mystore.api    
     - mystore.identity    
    networks:      
      - mystore

  mystore.proxy:
    container_name: mystore.proxy
    image: ${DOCKER_REGISTRY-}mystore.proxy
    build:
      context: .
      dockerfile: Proxy/Dockerfile
    restart: always  
    depends_on:
     - mystore.store
     - mystore.support
     - mystore.identity
     - mystore.api
    networks:      
      - mystore

  mystore.identity:
    container_name:  mystore.identity
    image: ${DOCKER_REGISTRY-}mystore.identity
    build:
      context: .
      dockerfile: Identity/Dockerfile
    restart: always  
    depends_on:
     - mystore.mongo
    networks:      
      - mystore

  mystore.api:
    container_name: mystore.api   
    image: ${DOCKER_REGISTRY-}mystore.api
    build:
      context: .
      dockerfile: Api/Dockerfile
    restart: always  
    depends_on:
     - mystore.identity
     - mystore.mongo
    networks:
      - mystore

  mystore.mongo:
    container_name: mystore.mongo
    image: ${DOCKER_REGISTRY-}mystore.mongo
    build:
      context: .
      dockerfile: MongoDB/Dockerfile
    restart: always  
    networks: 
      - mystore

networks:  
    mystore: